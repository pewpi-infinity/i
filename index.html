<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Octave OS - Infinity Terminal</title>
  <style>
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; background:#e9f0f6; color:#0b2a3d; padding:20px; }
    .terminal { background:#052b3a; color:#7be6ff; padding:18px; border-radius:8px; max-width:760px; margin: 0 auto 20px; font-family: monospace; }
    .logger { max-width:760px; margin: 0 auto; background:#fff; padding:16px; border-radius:8px; box-shadow: 0 2px 6px rgba(0,0,0,0.08); }
    textarea { width:100%; height:120px; font-family: inherit; font-size:14px; padding:8px; box-sizing:border-box; }
    button { padding:8px 12px; font-size:14px; margin-top:8px; }
    #log-status { display:block; margin-top:8px; color:#333; }
  </style>
</head>
<body>
  <div class="terminal">
    <div>Octave OS v0.12 - Frontend-only logger ready.</div>
    <div style="margin-top:8px; color:#9ee6ff;">Choose a logging method and press Enter.</div>
  </div>

  <div class="logger">
    <h3>Frontend logger</h3>
    <label for="log-input">Type conversation text to record:</label>
    <textarea id="log-input" placeholder="Type message to append to logs/txt.log..."></textarea>
    <div>
      <button id="log-send-btn">Send to log</button>
      <button id="log-clear-btn">Clear</button>
    </div>
    <span id="log-status"></span>
    <p style="font-size:12px; color:#666; margin-top:12px;">
      Note: The frontend will POST typed text to the local commit server which commits to GitHub.
      Do NOT store GitHub tokens in the browser.
    </p>
  </div>

  <!-- Commit client script (served from /static/js/commit-client.js) -->
  <script src="/static/js/commit-client.js"></script>
  <script>
    // OPTIONAL: if you want to embed the commit secret into the page (less secure),
    // set window.COMMIT_SECRET = 'your-secret-here' on the server-rendered page.
    // window.COMMIT_SECRET = '';

    document.addEventListener('DOMContentLoaded', function() {
      const input = document.getElementById('log-input');
      const sendBtn = document.getElementById('log-send-btn');
      const clearBtn = document.getElementById('log-clear-btn');
      const status = document.getElementById('log-status');

      function setStatus(msg, isError) {
        status.textContent = msg;
        status.style.color = isError ? '#b00020' : '#0a6f2b';
      }

      sendBtn.addEventListener('click', async function() {
        const text = input.value;
        if (!text || !text.trim()) { setStatus('Type something to send', true); return; }
        setStatus('Sending...', false);
        try {
          const result = await window.CommitClient.send(text);
          setStatus('Logged â€” commit: ' + (result.commit || '(unknown)'), false);
        } catch (err) {
          console.error('Commit error', err);
          setStatus('Error: ' + (err.message || 'unknown'), true);
        }
      });

      clearBtn.addEventListener('click', function() {
        input.value = '';
        setStatus('', false);
      });
    });
  </script>
</body>
</html>